import{_ as w,c as l,a as t,f as y,g as f,v as k,G as D,F as u,e as _,j as v,b as g,t as o,x as b,o as d,n as M,y as m}from"./index-wRRb0eXn.js";const C={name:"AnalyticsPage",data(){return{searchQuery:"",isSearching:!1,universities:[],selectedUniversity:null,degrees:[],selectedDegree:null,loading:!1,error:!1,errorMessage:"",analyticsData:[],sortMethod:"name"}},computed:{hasModules(){return this.analyticsData&&this.analyticsData.length>0},sortedModules(){return this.analyticsData?[...this.analyticsData].sort((s,e)=>{switch(this.sortMethod){case"name":return s.name.localeCompare(e.name);case"code":return s.code.localeCompare(e.code);case"average-desc":return e.average_score-s.average_score;case"average-asc":return s.average_score-e.average_score;case"popularity":return e.student_counter-s.student_counter;default:return 0}}):[]},topModulesToShow(){return[...this.sortedModules].sort((s,e)=>e.student_counter-s.student_counter).slice(0,4)},averageModuleScore(){if(!this.analyticsData||this.analyticsData.length===0)return 0;const s=this.analyticsData.reduce((e,a)=>e+a.average_score,0);return Math.round(s/this.analyticsData.length*10)/10},totalStudents(){return!this.analyticsData||this.analyticsData.length===0?0:Math.max(...this.analyticsData.map(s=>s.student_counter))}},methods:{searchUniversity(){!this.searchQuery.trim()||this.isSearching||(this.isSearching=!0,this.error=!1,this.universities=[],this.selectedUniversity=null,this.degrees=[],this.selectedDegree=null,this.analyticsData=[],setTimeout(()=>{this.searchUniversityAPI(this.searchQuery).then(s=>{this.universities=s.data||[],this.universities.length===0&&(this.error=!0,this.errorMessage="No universities found matching your search.")}).catch(s=>{var e,a;console.error("Error searching universities:",s),this.error=!0,this.errorMessage=((a=(e=s.response)==null?void 0:e.data)==null?void 0:a.error)||"Failed to search for universities. Please try again."}).finally(()=>{this.isSearching=!1})},800))},async searchUniversityAPI(s){try{return{data:[{id:"University of Southampton",name:"University of Southampton",counter:1},{id:"University of Cambridge",name:"University of Cambridge",counter:0},{id:"University of Oxford",name:"University of Oxford",counter:0},{id:"University of Edinburgh",name:"University of Edinburgh",counter:3}].filter(c=>c.name.toLowerCase().includes(s.toLowerCase()))}}catch(e){throw console.error("Error in searchUniversityAPI:",e),e}},getDegreesCount(s){return s.counter||0},selectUniversity(s){this.selectedUniversity=s,this.selectedDegree=null,this.analyticsData=[],this.loading=!0,this.error=!1,this.fetchUniversityDegrees(s.id).then(e=>{this.degrees=e.data||[],this.degrees.length===0&&(this.error=!0,this.errorMessage="No degrees found for this university.")}).catch(e=>{var a,c;console.error("Error fetching university degrees:",e),this.error=!0,this.errorMessage=((c=(a=e.response)==null?void 0:a.data)==null?void 0:c.error)||"Failed to load degree programs. Please try again."}).finally(()=>{this.loading=!1})},async fetchUniversityDegrees(s){try{return s==="University of Southampton"?{data:["COMPUTER SCIENCE","ENGINEERING","MATHEMATICS"]}:s==="University of Edinburgh"?{data:["COMPUTER SCIENCE","ENGINEERING","MATHEMATICS","ACCOUNTING"]}:{data:["COMPUTER SCIENCE"]}}catch(e){throw console.error("Error in fetchUniversityDegrees:",e),e}},selectDegree(s){this.selectedDegree=s,this.loading=!0,this.error=!1,this.analyticsData=[],this.fetchModuleAnalytics(this.selectedUniversity.id,s).then(e=>{this.analyticsData=e.data||[],this.analyticsData.length===0&&(this.error=!0,this.errorMessage="No analytics data available for this degree program.")}).catch(e=>{var a,c;console.error("Error fetching module analytics:",e),this.error=!0,this.errorMessage=((c=(a=e.response)==null?void 0:a.data)==null?void 0:c.error)||"Failed to load analytics data. Please try again."}).finally(()=>{this.loading=!1})},async fetchModuleAnalytics(s,e){try{return s==="University of Southampton"&&e==="COMPUTER SCIENCE"?{data:[{name:"Programming I",code:"COMP1001",average_score:82,student_counter:32,grade_distribution:{"81-90%":15,"71-80%":10,"61-70%":5,"51-60%":2}},{name:"Programming II",code:"COMP1002",average_score:75,student_counter:29,grade_distribution:{"71-80%":14,"61-70%":8,"51-60%":4,"81-90%":3}},{name:"Databases",code:"COMP2007",average_score:68,student_counter:26,grade_distribution:{"61-70%":12,"71-80%":8,"51-60%":4,"41-50%":2}},{name:"Web Development",code:"COMP2011",average_score:71,student_counter:28,grade_distribution:{"71-80%":13,"61-70%":9,"81-90%":4,"51-60%":2}}]}:s==="University of Edinburgh"&&e==="ACCOUNTING"?{data:[{name:"Accountancy 1A",code:"ACCT1001",average_score:59.5,student_counter:12,grade_distribution:{"51-60%":3,"61-70%":3,"71-80%":4,"81-90%":1,"41-50%":1}},{name:"Accountancy 1B",code:"ACCT1002",average_score:62,student_counter:11,grade_distribution:{"51-60%":2,"61-70%":5,"71-80%":3,"41-50%":1}}]}:{data:[]}}catch(a){throw console.error("Error in fetchModuleAnalytics:",a),a}},retryFetch(){this.selectedDegree?this.selectDegree(this.selectedDegree):this.selectedUniversity?this.selectUniversity(this.selectedUniversity):this.searchUniversity()},getDifficultyPercentage(s){return Math.max(0,Math.min(100,100-s))},getDifficultyRating(s){return Math.round(100-s)},getTeachingQualityPercentage(s){return Math.max(0,Math.min(100,s))},getTeachingQualityRating(s){return Math.round(s)},getRecommendedPercentage(s){return s>=80?90:s>=70?75:s>=60?60:s>=50?40:20},getRecommendedRating(s){return this.getRecommendedPercentage(s)},calculateBarHeight(s,e){return e?Math.min(100,Math.max(10,s/e*100)):0},formatGradeRange(s){const e=s.split("-");return e.length===2?e[0]+"%":s},getEmptyBarsCount(s){const e=Object.keys(s).length;return Math.max(0,5-e)},getDifficultyAssessment(){return!this.analyticsData||this.analyticsData.length===0?"":this.averageModuleScore>=75?`Modules in this degree program have an average score of ${this.averageModuleScore}%, which suggests students generally find them manageable.`:this.averageModuleScore>=65?`Modules in this degree program have a moderate difficulty level with an average score of ${this.averageModuleScore}%.`:this.averageModuleScore>=55?`Modules in this degree program appear to be somewhat challenging with an average score of ${this.averageModuleScore}%.`:`Modules in this degree program seem to be difficult for many students, with a relatively low average score of ${this.averageModuleScore}%.`},getGradeDistributionInsight(){if(!this.analyticsData||this.analyticsData.length===0)return"";const s={};let e=0;if(this.analyticsData.forEach(i=>{Object.entries(i.grade_distribution||{}).forEach(([n,r])=>{s[n]=(s[n]||0)+r,e+=r})}),e===0)return"No grade distribution data is available yet.";const a=Object.entries(s).sort((i,n)=>n[1]-i[1])[0];return`Most students (${Math.round(a[1]/e*100)}%) scored in the ${a[0]} range across all modules in this degree program.`},getParticipationInsight(){if(!this.analyticsData||this.analyticsData.length===0)return"";const s=this.analyticsData.length,e=this.analyticsData.reduce((c,i)=>c+i.student_counter,0)/s,a=Math.round(e*10)/10;return a>=50?`This degree program has high participation with an average of ${a} students per module.`:a>=20?`This degree program has moderate participation with an average of ${a} students per module.`:a>=5?`This degree program has low participation with an average of ${a} students per module.`:`This degree program has very few participants with an average of ${a} students per module.`}},mounted(){const s=this.$route.query.universityId,e=this.$route.query.degree;s&&(this.loading=!0,setTimeout(()=>{const a={id:s,name:s,counter:1};if(this.universities=[a],this.selectUniversity(a),e){const c=()=>{this.degrees.includes(e)&&this.selectDegree(e)},i=setInterval(()=>{this.degrees.length>0&&(c(),clearInterval(i))},100);setTimeout(()=>clearInterval(i),5e3)}},500))}},U={class:"analytics-page"},x={class:"search-section"},S={class:"search-card"},E={class:"search-form"},A={class:"input-group"},T=["disabled"],P=["disabled"],N={key:0,class:"button-spinner"},I={key:0,class:"university-results"},R={class:"university-list"},B=["onClick"],O={class:"university-name"},j={class:"university-info"},G={key:1,class:"degree-selection"},Q={class:"degree-list"},V=["onClick"],F={key:0,class:"loading-container"},H={key:1,class:"error-container"},L={key:2,class:"empty-container"},q={key:3,class:"analytics-content"},z={class:"filter-controls"},K={class:"filter-group"},W={class:"module-cards-container"},J={class:"module-header"},X={class:"university-tag"},Y={class:"module-cards-grid"},Z={class:"module-card-header"},$={class:"module-code-pill"},ee={class:"module-card-content"},te={class:"module-details"},se={class:"detail-item"},re={class:"value"},ie={class:"detail-item"},ae={class:"value"},ne={class:"detail-item"},oe={class:"value"},le={class:"module-gradeometer"},de={class:"gradeometer-content"},ce={class:"gradeometer-percentage"},he={class:"percentage-value"},ue={class:"students-count"},ge={class:"gradeometer-metrics"},ve={class:"metric"},ye={class:"metric-bar-container"},me={class:"metric-value"},pe={class:"metric"},fe={class:"metric-bar-container"},_e={class:"metric-value"},Me={class:"metric"},we={class:"metric-bar-container"},ke={class:"metric-value"},De={class:"student-averages"},be={class:"averages-chart"},Ce={class:"chart-bars"},Ue={class:"bar-count"},xe={class:"bar-label"},Se={class:"chart-axis"},Ee={key:0,class:"university-stats"},Ae={class:"stats-cards"},Te={class:"stats-card"},Pe={class:"stat-content"},Ne={class:"stats-card"},Ie={class:"stat-content"},Re={class:"stats-card"},Be={class:"stat-content"};function Oe(s,e,a,c,i,n){return d(),l("div",U,[e[35]||(e[35]=t("div",{class:"analytics-header"},[t("h1",null,"Module Analytics"),t("p",{class:"subtitle"},"View and compare module performance across universities")],-1)),t("div",x,[t("div",S,[e[9]||(e[9]=t("h2",null,"Search for a University",-1)),t("div",E,[t("div",A,[f(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=r=>i.searchQuery=r),placeholder:"Enter university name...",onKeyup:e[1]||(e[1]=D((...r)=>n.searchUniversity&&n.searchUniversity(...r),["enter"])),disabled:i.isSearching},null,40,T),[[k,i.searchQuery]]),t("button",{onClick:e[2]||(e[2]=(...r)=>n.searchUniversity&&n.searchUniversity(...r)),disabled:i.isSearching||!i.searchQuery.trim(),class:"search-button"},[i.isSearching?(d(),l("div",N)):(d(),l(u,{key:1},[e[5]||(e[5]=t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("circle",{cx:"11",cy:"11",r:"8"}),t("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})],-1)),e[6]||(e[6]=_(" Search "))],64))],8,P)])]),i.universities.length>0?(d(),l("div",I,[e[7]||(e[7]=t("h3",null,"Select a University",-1)),t("div",R,[(d(!0),l(u,null,v(i.universities,r=>(d(),l("div",{key:r.id,class:M(["university-item",{active:i.selectedUniversity&&i.selectedUniversity.id===r.id}]),onClick:h=>n.selectUniversity(r)},[t("div",O,o(r.name),1),t("div",j,o(n.getDegreesCount(r))+" degrees",1)],10,B))),128))])])):y("",!0),i.selectedUniversity&&i.degrees.length>0?(d(),l("div",G,[e[8]||(e[8]=t("h3",null,"Select a Degree",-1)),t("div",Q,[(d(!0),l(u,null,v(i.degrees,r=>(d(),l("div",{key:r,class:M(["degree-item",{active:i.selectedDegree===r}]),onClick:h=>n.selectDegree(r)},o(r),11,V))),128))])])):y("",!0)])]),i.loading?(d(),l("div",F,e[10]||(e[10]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"Loading analytics data...",-1)]))):i.error?(d(),l("div",H,[e[12]||(e[12]=g('<div class="error-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg></div><h3>Error Loading Analytics</h3>',2)),t("p",null,o(i.errorMessage),1),t("button",{onClick:e[3]||(e[3]=(...r)=>n.retryFetch&&n.retryFetch(...r)),class:"retry-button"},e[11]||(e[11]=[g('<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 2v6h-6"></path><path d="M3 12a9 9 0 0 1 15-6.7l3-3"></path><path d="M3 22v-6h6"></path><path d="M21 12a9 9 0 0 1-15 6.7l-3 3"></path></svg> Try Again ',2)]))])):i.selectedDegree&&!n.hasModules?(d(),l("div",L,e[13]||(e[13]=[g('<div class="empty-icon"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="9" y1="9" x2="15" y2="15"></line><line x1="15" y1="9" x2="9" y2="15"></line></svg></div><h3>No Analytics Available</h3><p>We don&#39;t have enough data to show analytics for modules in this degree program yet.</p>',3)]))):i.selectedDegree&&n.hasModules?(d(),l("div",q,[t("div",z,[t("div",K,[e[15]||(e[15]=t("label",{for:"sortBy"},"Sort By:",-1)),f(t("select",{id:"sortBy","onUpdate:modelValue":e[4]||(e[4]=r=>i.sortMethod=r)},e[14]||(e[14]=[g('<option value="name">Module Name</option><option value="code">Module Code</option><option value="average-desc">Average Score (High to Low)</option><option value="average-asc">Average Score (Low to High)</option><option value="popularity">Number of Students</option>',5)]),512),[[b,i.sortMethod]])])]),t("div",W,[t("div",J,[t("h2",null,"Module Analytics for "+o(i.selectedDegree),1),t("p",X,o(i.selectedUniversity.name),1)]),t("div",Y,[(d(!0),l(u,null,v(n.sortedModules,r=>(d(),l("div",{key:r.code,class:"module-card"},[t("div",Z,[t("h3",null,[_(o(r.name)+" ",1),t("span",$,o(r.code),1)]),e[16]||(e[16]=t("div",{class:"back-button"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M19 12H5M12 19l-7-7 7-7"})])],-1))]),t("div",ee,[t("div",te,[e[20]||(e[20]=t("h4",null,"Module Details",-1)),t("div",se,[e[17]||(e[17]=t("span",{class:"label"},"University:",-1)),t("span",re,o(i.selectedUniversity.name),1)]),t("div",ie,[e[18]||(e[18]=t("span",{class:"label"},"Number of Students:",-1)),t("span",ae,o(r.student_counter),1)]),t("div",ne,[e[19]||(e[19]=t("span",{class:"label"},"Average Score:",-1)),t("span",oe,o(r.average_score)+"%",1)])]),t("div",le,[e[25]||(e[25]=t("h4",null,"GRADEOMETER",-1)),t("div",de,[e[21]||(e[21]=t("div",{class:"gradeometer-icon"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#7b49ff","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M12 2v1M12 21v1M4.2 4.2l.8.8M19 19l.8.8M2 12h1M21 12h1M6 18.75l-.5.75M18.5 5l-.5.75"}),t("circle",{cx:"12",cy:"12",r:"4"})])],-1)),t("div",ce,[t("span",he,o(r.average_score)+"%",1),t("span",ue,o(r.student_counter)+" students",1)])]),t("div",ge,[t("div",ve,[e[22]||(e[22]=t("div",{class:"metric-label"},"Difficulty",-1)),t("div",ye,[t("div",{class:"metric-bar",style:m({width:n.getDifficultyPercentage(r.average_score)+"%"})},null,4)]),t("div",me,o(n.getDifficultyRating(r.average_score))+"%",1)]),t("div",pe,[e[23]||(e[23]=t("div",{class:"metric-label"},"Teaching Quality",-1)),t("div",fe,[t("div",{class:"metric-bar",style:m({width:n.getTeachingQualityPercentage(r.average_score)+"%"})},null,4)]),t("div",_e,o(n.getTeachingQualityRating(r.average_score))+"%",1)]),t("div",Me,[e[24]||(e[24]=t("div",{class:"metric-label"},"Recommended",-1)),t("div",we,[t("div",{class:"metric-bar",style:m({width:n.getRecommendedPercentage(r.average_score)+"%"})},null,4)]),t("div",ke,o(n.getRecommendedRating(r.average_score))+"%",1)])])]),t("div",De,[e[27]||(e[27]=t("h4",null,"Student Averages",-1)),t("div",be,[t("div",Ce,[(d(!0),l(u,null,v(r.grade_distribution,(h,p)=>(d(),l("div",{key:p,class:"chart-bar-container"},[t("div",{class:"chart-bar",style:m({height:n.calculateBarHeight(h,r.student_counter)+"%"})},[t("div",Ue,o(h),1)],4),t("div",xe,o(n.formatGradeRange(p)),1)]))),128)),(d(!0),l(u,null,v(n.getEmptyBarsCount(r.grade_distribution),h=>(d(),l("div",{key:"empty-"+h,class:"chart-bar-container empty"},e[26]||(e[26]=[t("div",{class:"chart-bar empty"},null,-1),t("div",{class:"bar-label"},"-",-1)])))),128))]),t("div",Se,[(d(),l(u,null,v(6,h=>t("div",{key:h,class:"axis-mark"},o((h-1)*20)+"%",1)),64))])])])])]))),128))])]),n.hasModules?(d(),l("div",Ee,[e[34]||(e[34]=t("h2",null,"University Module Statistics",-1)),t("div",Ae,[t("div",Te,[e[29]||(e[29]=g('<div class="stat-icon difficulty"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20v-6M12 14l-2.5-2"></path><path d="M12 14l2.5-2"></path><path d="M12 4v6"></path><path d="M12 10l-2.5 2"></path><path d="M12 10l2.5 2"></path></svg></div>',1)),t("div",Pe,[e[28]||(e[28]=t("h3",null,"Module Difficulty",-1)),t("p",null,o(n.getDifficultyAssessment()),1)])]),t("div",Ne,[e[31]||(e[31]=g('<div class="stat-icon distribution"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 20h20"></path><path d="M5 20v-4"></path><path d="M9 20v-8"></path><path d="M13 20V10"></path><path d="M17 20v-6"></path><path d="M21 20V6"></path></svg></div>',1)),t("div",Ie,[e[30]||(e[30]=t("h3",null,"Grade Distribution",-1)),t("p",null,o(n.getGradeDistributionInsight()),1)])]),t("div",Re,[e[33]||(e[33]=g('<div class="stat-icon popularity"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg></div>',1)),t("div",Be,[e[32]||(e[32]=t("h3",null,"Student Participation",-1)),t("p",null,o(n.getParticipationInsight()),1)])])])])):y("",!0)])):y("",!0)])}const Ge=w(C,[["render",Oe]]);export{Ge as default};
